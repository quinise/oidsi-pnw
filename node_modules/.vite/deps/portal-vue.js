import {
  computed,
  createApp,
  defineComponent,
  getCurrentInstance,
  h,
  inject,
  onBeforeUnmount,
  onMounted,
  onUpdated,
  provide,
  reactive,
  readonly,
  watch
} from "./chunk-2FDUVFJ5.js";

// node_modules/portal-vue/dist/portal-vue.es.js
var f = Symbol("wormhole");
function m() {
  const e = inject(f);
  if (!e)
    throw new Error("\n    [portal-vue]: Necessary Injection not found. Make sur you installed the plugin properly.");
  return e;
}
function v(t) {
  provide(f, t);
}
var g = "undefined" != typeof window;
var y = defineComponent({ compatConfig: { MODE: 3 }, name: "portal", props: { disabled: { type: Boolean }, name: { type: [String, Symbol], default: () => Symbol() }, order: { type: Number }, slotProps: { type: Object, default: () => ({}) }, to: { type: String, default: () => String(Math.round(1e7 * Math.random())) } }, setup: (t, { slots: e }) => (function(t2, e2) {
  const o = m();
  function s() {
    if (!g)
      return;
    const { to: n, name: r, order: a } = t2;
    e2.default ? o.open({ to: n, from: r, order: a, content: e2.default }) : u();
  }
  function u(e3) {
    o.close({ to: null != e3 ? e3 : t2.to, from: t2.name });
  }
  onMounted(() => {
    t2.disabled || s();
  }), onUpdated(() => {
    t2.disabled ? u() : s();
  }), onBeforeUnmount(() => {
    u();
  }), watch(() => t2.to, (e3, o2) => {
    t2.disabled || (o2 && o2 !== e3 && u(o2), s());
  });
}(t, e), () => t.disabled && e.default ? e.default(t.slotProps) : null) });
var h2 = (t, { slots: e }) => {
  var o;
  return null === (o = e.default) || void 0 === o ? void 0 : o.call(e);
};
var b = defineComponent({ compatConfig: { MODE: 3 }, name: "portalTarget", props: { multiple: { type: Boolean, default: false }, name: { type: String, required: true }, slotProps: { type: Object, default: () => ({}) } }, emits: ["change"], setup(t, { emit: e, slots: o }) {
  const n = m(), r = computed(() => {
    const e2 = n.getContentForTarget(t.name, t.multiple), r2 = o.wrapper, a = e2.map((e3) => e3.content(t.slotProps)), l = r2 ? a.flatMap((t2) => t2.length ? r2(t2) : []) : a.flat(1);
    return { vnodes: l, vnodesFn: () => l };
  });
  return watch(r, ({ vnodes: o2 }) => {
    const r2 = o2.length > 0, a = n.transports.get(t.name), l = a ? [...a.keys()] : [];
    e("change", { hasContent: r2, sources: l });
  }, { flush: "post" }), () => {
    var t2;
    return !!r.value.vnodes.length ? [h("div", { style: "display: none", key: "__portal-vue-hacky-scoped-slot-repair__" }), h(h2, r.value.vnodesFn)] : null === (t2 = o.default) || void 0 === t2 ? void 0 : t2.call(o);
  };
} });
function w(t = true) {
  const e = reactive(/* @__PURE__ */ new Map());
  const o = { open: function(t2) {
    if (!g)
      return;
    const { to: o2, from: n, content: r, order: a = 1 / 0 } = t2;
    if (!o2 || !n || !r)
      return;
    e.has(o2) || e.set(o2, /* @__PURE__ */ new Map());
    const l = { to: o2, from: n, content: r, order: a };
    e.get(o2).set(n, l);
  }, close: function(t2) {
    const { to: o2, from: n } = t2;
    if (!o2 || !n)
      return;
    const r = e.get(o2);
    r && (r.delete(n), r.size || e.delete(o2));
  }, transports: e, getContentForTarget: function(t2, o2) {
    const n = e.get(t2);
    if (!n)
      return [];
    const r = Array.from((null == n ? void 0 : n.values()) || []);
    return o2 ? (a = (t3, e2) => t3.order - e2.order, r.map((t3, e2) => [e2, t3]).sort(function(t3, e2) {
      return a(t3[1], e2[1]) || t3[0] - e2[0];
    }).map((t3) => t3[1])) : [r.pop()];
    var a;
  } };
  return t ? readonly(o) : o;
}
var M = w();
function S(t, e) {
  var o;
  const r = createApp({ render: () => h(b, t) });
  if (!t.multiple) {
    const t2 = null !== (o = getCurrentInstance().provides) && void 0 !== o ? o : {};
    r._context.provides = Object.create(t2);
  }
  onMounted(() => {
    r.mount(e);
  }), onBeforeUnmount(() => {
    r.unmount();
  });
}
function N(t, e = {}) {
  var o;
  false !== e.portalName && t.component(e.portalName || "Portal", y), false !== e.portalTargetName && t.component(e.portalTargetName || "PortalTarget", b);
  const n = null !== (o = e.wormhole) && void 0 !== o ? o : M;
  t.provide(f, n);
}
var P = M;
var T = "3.0.0-beta.0";
var portal_vue_es_default = N;
export {
  y as Portal,
  b as PortalTarget,
  P as Wormhole,
  w as createWormhole,
  portal_vue_es_default as default,
  N as install,
  S as mountPortalTarget,
  v as provideWormhole,
  m as useWormhole,
  T as version
};
/*! Bundled license information:

portal-vue/dist/portal-vue.es.js:
  (**
   *  Copyright 2021 Thorsten Luenborg 
   *  @license MIT
   *)
*/
//# sourceMappingURL=portal-vue.js.map
